<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- |

A rich user interface for line input in command-line programs.  Haskeline is
Unicode-aware and runs both on POSIX-compatible systems and on Windows.

Users may customize the interface with a @~/.haskeline@ file; see
&lt;https://github.com/judah/haskeline/wiki/UserPreferences&gt; for more information.

An example use of this library for a simple read-eval-print loop (REPL) is the
following:

&gt; import System.Console.Haskeline
&gt;
&gt; main :: IO ()
&gt; main = runInputT defaultSettings loop
&gt;    where
&gt;        loop :: InputT IO ()
&gt;        loop = do
&gt;            minput &lt;- getInputLine &quot;% &quot;
&gt;            case minput of
&gt;                Nothing -&gt; return ()
&gt;                Just &quot;quit&quot; -&gt; return ()
&gt;                Just input -&gt; do outputStrLn $ &quot;Input was: &quot; ++ input
&gt;                                 loop

-}</span><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System.Console.Haskeline</span><span class="hs-special">(</span><span>
</span><a name="line-30"></a><span>                    </span><span class="hs-comment">-- * Interactive sessions</span><span>
</span><a name="line-31"></a><span>                    </span><span class="hs-comment">-- ** The InputT monad transformer</span><span>
</span><a name="line-32"></a><span>                    </span><a href="System.Console.Haskeline.InputT.html#InputT"><span class="hs-identifier hs-type">InputT</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>                    </span><a href="System.Console.Haskeline.InputT.html#runInputT"><span class="hs-identifier hs-var">runInputT</span></a><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>                    </span><a href="System.Console.Haskeline.InputT.html#haveTerminalUI"><span class="hs-identifier hs-var">haveTerminalUI</span></a><span class="hs-special">,</span><span>
</span><a name="line-35"></a><span>                    </span><a href="System.Console.Haskeline.InputT.html#mapInputT"><span class="hs-identifier hs-var">mapInputT</span></a><span class="hs-special">,</span><span>
</span><a name="line-36"></a><span>                    </span><span class="hs-comment">-- ** Behaviors</span><span>
</span><a name="line-37"></a><span>                    </span><a href="System.Console.Haskeline.InputT.html#Behavior"><span class="hs-identifier hs-type">Behavior</span></a><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>                    </span><a href="System.Console.Haskeline.InputT.html#runInputTBehavior"><span class="hs-identifier hs-var">runInputTBehavior</span></a><span class="hs-special">,</span><span>
</span><a name="line-39"></a><span>                    </span><a href="System.Console.Haskeline.InputT.html#defaultBehavior"><span class="hs-identifier hs-var">defaultBehavior</span></a><span class="hs-special">,</span><span>
</span><a name="line-40"></a><span>                    </span><a href="System.Console.Haskeline.InputT.html#useFileHandle"><span class="hs-identifier hs-var">useFileHandle</span></a><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>                    </span><a href="System.Console.Haskeline.InputT.html#useFile"><span class="hs-identifier hs-var">useFile</span></a><span class="hs-special">,</span><span>
</span><a name="line-42"></a><span>                    </span><a href="System.Console.Haskeline.InputT.html#preferTerm"><span class="hs-identifier hs-var">preferTerm</span></a><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>                    </span><span class="hs-comment">-- * User interaction functions</span><span>
</span><a name="line-44"></a><span>                    </span><span class="hs-comment">-- ** Reading user input</span><span>
</span><a name="line-45"></a><span>                    </span><span class="hs-comment">-- $inputfncs</span><span>
</span><a name="line-46"></a><span>                    </span><a href="System.Console.Haskeline.html#getInputLine"><span class="hs-identifier hs-var">getInputLine</span></a><span class="hs-special">,</span><span>
</span><a name="line-47"></a><span>                    </span><a href="System.Console.Haskeline.html#getInputLineWithInitial"><span class="hs-identifier hs-var">getInputLineWithInitial</span></a><span class="hs-special">,</span><span>
</span><a name="line-48"></a><span>                    </span><a href="System.Console.Haskeline.html#getInputChar"><span class="hs-identifier hs-var">getInputChar</span></a><span class="hs-special">,</span><span>
</span><a name="line-49"></a><span>                    </span><a href="System.Console.Haskeline.html#getPassword"><span class="hs-identifier hs-var">getPassword</span></a><span class="hs-special">,</span><span>
</span><a name="line-50"></a><span>                    </span><span class="hs-comment">-- ** Outputting text</span><span>
</span><a name="line-51"></a><span>                    </span><span class="hs-comment">-- $outputfncs</span><span>
</span><a name="line-52"></a><span>                    </span><a href="System.Console.Haskeline.html#outputStr"><span class="hs-identifier hs-var">outputStr</span></a><span class="hs-special">,</span><span>
</span><a name="line-53"></a><span>                    </span><a href="System.Console.Haskeline.html#outputStrLn"><span class="hs-identifier hs-var">outputStrLn</span></a><span class="hs-special">,</span><span>
</span><a name="line-54"></a><span>                    </span><a href="System.Console.Haskeline.html#getExternalPrint"><span class="hs-identifier hs-var">getExternalPrint</span></a><span class="hs-special">,</span><span>
</span><a name="line-55"></a><span>                    </span><span class="hs-comment">-- * Customization</span><span>
</span><a name="line-56"></a><span>                    </span><span class="hs-comment">-- ** Settings</span><span>
</span><a name="line-57"></a><span>                    </span><a href="System.Console.Haskeline.InputT.html#Settings"><span class="hs-identifier hs-type">Settings</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-58"></a><span>                    </span><a href="System.Console.Haskeline.html#defaultSettings"><span class="hs-identifier hs-var">defaultSettings</span></a><span class="hs-special">,</span><span>
</span><a name="line-59"></a><span>                    </span><a href="System.Console.Haskeline.InputT.html#setComplete"><span class="hs-identifier hs-var">setComplete</span></a><span class="hs-special">,</span><span>
</span><a name="line-60"></a><span>                    </span><span class="hs-comment">-- ** User preferences</span><span>
</span><a name="line-61"></a><span>                    </span><a href="System.Console.Haskeline.Prefs.html#Prefs"><span class="hs-identifier hs-type">Prefs</span></a><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-62"></a><span>                    </span><a href="System.Console.Haskeline.Prefs.html#readPrefs"><span class="hs-identifier hs-var">readPrefs</span></a><span class="hs-special">,</span><span>
</span><a name="line-63"></a><span>                    </span><a href="System.Console.Haskeline.Prefs.html#defaultPrefs"><span class="hs-identifier hs-var">defaultPrefs</span></a><span class="hs-special">,</span><span>
</span><a name="line-64"></a><span>                    </span><a href="System.Console.Haskeline.InputT.html#runInputTWithPrefs"><span class="hs-identifier hs-var">runInputTWithPrefs</span></a><span class="hs-special">,</span><span>
</span><a name="line-65"></a><span>                    </span><a href="System.Console.Haskeline.InputT.html#runInputTBehaviorWithPrefs"><span class="hs-identifier hs-var">runInputTBehaviorWithPrefs</span></a><span class="hs-special">,</span><span>
</span><a name="line-66"></a><span>                    </span><span class="hs-comment">-- ** History</span><span>
</span><a name="line-67"></a><span>                    </span><span class="hs-comment">-- $history</span><span>
</span><a name="line-68"></a><span>                    </span><a href="System.Console.Haskeline.InputT.html#getHistory"><span class="hs-identifier hs-var">getHistory</span></a><span class="hs-special">,</span><span>
</span><a name="line-69"></a><span>                    </span><a href="System.Console.Haskeline.InputT.html#putHistory"><span class="hs-identifier hs-var">putHistory</span></a><span class="hs-special">,</span><span>
</span><a name="line-70"></a><span>                    </span><a href="System.Console.Haskeline.InputT.html#modifyHistory"><span class="hs-identifier hs-var">modifyHistory</span></a><span class="hs-special">,</span><span>
</span><a name="line-71"></a><span>                    </span><span class="hs-comment">-- * Ctrl-C handling</span><span>
</span><a name="line-72"></a><span>                    </span><a href="System.Console.Haskeline.html#withInterrupt"><span class="hs-identifier hs-var">withInterrupt</span></a><span class="hs-special">,</span><span>
</span><a name="line-73"></a><span>                    </span><a href="System.Console.Haskeline.Term.html#Interrupt"><span class="hs-identifier hs-type">Interrupt</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-74"></a><span>                    </span><a href="System.Console.Haskeline.html#handleInterrupt"><span class="hs-identifier hs-var">handleInterrupt</span></a><span class="hs-special">,</span><span>
</span><a name="line-75"></a><span>                    </span><span class="hs-comment">-- * Additional submodules</span><span>
</span><a name="line-76"></a><span>                    </span><span class="hs-keyword">module</span><span> </span><a href="System.Console.Haskeline.Completion.html"><span class="hs-identifier">System.Console.Haskeline.Completion</span></a><span class="hs-special">,</span><span>
</span><a name="line-77"></a><span>                    </span><span class="hs-keyword">module</span><span> </span><a href="System.Console.Haskeline.MonadException.html"><span class="hs-identifier">System.Console.Haskeline.MonadException</span></a><span class="hs-special">)</span><span>
</span><a name="line-78"></a><span>                     </span><span class="hs-keyword">where</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-keyword">import</span><span> </span><a href="System.Console.Haskeline.LineState.html"><span class="hs-identifier">System.Console.Haskeline.LineState</span></a><span>
</span><a name="line-81"></a><span class="hs-keyword">import</span><span> </span><a href="System.Console.Haskeline.Command.html"><span class="hs-identifier">System.Console.Haskeline.Command</span></a><span>
</span><a name="line-82"></a><span class="hs-keyword">import</span><span> </span><a href="System.Console.Haskeline.Vi.html"><span class="hs-identifier">System.Console.Haskeline.Vi</span></a><span>
</span><a name="line-83"></a><span class="hs-keyword">import</span><span> </span><a href="System.Console.Haskeline.Emacs.html"><span class="hs-identifier">System.Console.Haskeline.Emacs</span></a><span>
</span><a name="line-84"></a><span class="hs-keyword">import</span><span> </span><a href="System.Console.Haskeline.Prefs.html"><span class="hs-identifier">System.Console.Haskeline.Prefs</span></a><span>
</span><a name="line-85"></a><span class="hs-keyword">import</span><span> </span><a href="System.Console.Haskeline.History.html"><span class="hs-identifier">System.Console.Haskeline.History</span></a><span>
</span><a name="line-86"></a><span class="hs-keyword">import</span><span> </span><a href="System.Console.Haskeline.Monads.html"><span class="hs-identifier">System.Console.Haskeline.Monads</span></a><span>
</span><a name="line-87"></a><span class="hs-keyword">import</span><span> </span><a href="System.Console.Haskeline.MonadException.html"><span class="hs-identifier">System.Console.Haskeline.MonadException</span></a><span>
</span><a name="line-88"></a><span class="hs-keyword">import</span><span> </span><a href="System.Console.Haskeline.InputT.html"><span class="hs-identifier">System.Console.Haskeline.InputT</span></a><span>
</span><a name="line-89"></a><span class="hs-keyword">import</span><span> </span><a href="System.Console.Haskeline.Completion.html"><span class="hs-identifier">System.Console.Haskeline.Completion</span></a><span>
</span><a name="line-90"></a><span class="hs-keyword">import</span><span> </span><a href="System.Console.Haskeline.Term.html"><span class="hs-identifier">System.Console.Haskeline.Term</span></a><span>
</span><a name="line-91"></a><span class="hs-keyword">import</span><span> </span><a href="System.Console.Haskeline.Key.html"><span class="hs-identifier">System.Console.Haskeline.Key</span></a><span>
</span><a name="line-92"></a><span class="hs-keyword">import</span><span> </span><a href="System.Console.Haskeline.RunCommand.html"><span class="hs-identifier">System.Console.Haskeline.RunCommand</span></a><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/System.IO.html"><span class="hs-identifier">System.IO</span></a><span>
</span><a name="line-95"></a><span class="hs-keyword">import</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/Data.Char.html"><span class="hs-identifier">Data.Char</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Unicode.html#isSpace"><span class="hs-identifier hs-var">isSpace</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Unicode.html#isPrint"><span class="hs-identifier hs-var">isPrint</span></a><span class="hs-special">)</span><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-comment">-- | A useful default.  In particular:</span><span>
</span><a name="line-99"></a><span class="hs-comment">--</span><span>
</span><a name="line-100"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-101"></a><span class="hs-comment">-- defaultSettings = Settings {</span><span>
</span><a name="line-102"></a><span class="hs-comment">--           complete = completeFilename,</span><span>
</span><a name="line-103"></a><span class="hs-comment">--           historyFile = Nothing,</span><span>
</span><a name="line-104"></a><span class="hs-comment">--           autoAddHistory = True</span><span>
</span><a name="line-105"></a><span class="hs-comment">--           }</span><span>
</span><a name="line-106"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-107"></a><span class="hs-identifier">defaultSettings</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a><span> </span><a href="#local-6989586621679092744"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Haskeline.InputT.html#Settings"><span class="hs-identifier hs-type">Settings</span></a><span> </span><a href="#local-6989586621679092744"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-108"></a><a name="defaultSettings"><a href="System.Console.Haskeline.html#defaultSettings"><span class="hs-identifier">defaultSettings</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Haskeline.InputT.html#Settings"><span class="hs-identifier hs-var">Settings</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">complete</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Haskeline.Completion.html#completeFilename"><span class="hs-identifier hs-var">completeFilename</span></a><span class="hs-special">,</span><span>
</span><a name="line-109"></a><span>                        </span><span class="hs-identifier">historyFile</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span class="hs-special">,</span><span>
</span><a name="line-110"></a><span>                        </span><span class="hs-identifier">autoAddHistory</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">}</span><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span class="hs-comment">{- $outputfncs
The following functions enable cross-platform output of text that may contain
Unicode characters.
-}</span><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-comment">-- | Write a Unicode string to the user's standard output.</span><span>
</span><a name="line-118"></a><span class="hs-identifier">outputStr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a><span> </span><a href="#local-6989586621679092743"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.Haskeline.InputT.html#InputT"><span class="hs-identifier hs-type">InputT</span></a><span> </span><a href="#local-6989586621679092743"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-119"></a><a name="outputStr"><a href="System.Console.Haskeline.html#outputStr"><span class="hs-identifier">outputStr</span></a></a><span> </span><a name="local-6989586621679092745"><a href="#local-6989586621679092745"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-120"></a><span>    </span><a name="local-6989586621679092746"><a href="#local-6989586621679092746"><span class="hs-identifier">putter</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Console.Haskeline.InputT.html#InputT"><span class="hs-identifier hs-var">InputT</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="System.Console.Haskeline.Monads.html#asks"><span class="hs-identifier hs-var">asks</span></a><span> </span><span class="hs-identifier">putStrOut</span><span>
</span><a name="line-121"></a><span>    </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-6989586621679092746"><span class="hs-identifier hs-var">putter</span></a><span> </span><a href="#local-6989586621679092745"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-122"></a><span>
</span><a name="line-123"></a><span class="hs-comment">-- | Write a string to the user's standard output, followed by a newline.</span><span>
</span><a name="line-124"></a><span class="hs-identifier">outputStrLn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a><span> </span><a href="#local-6989586621679092742"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.Haskeline.InputT.html#InputT"><span class="hs-identifier hs-type">InputT</span></a><span> </span><a href="#local-6989586621679092742"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-125"></a><a name="outputStrLn"><a href="System.Console.Haskeline.html#outputStrLn"><span class="hs-identifier">outputStrLn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Haskeline.html#outputStr"><span class="hs-identifier hs-var">outputStr</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-string">&quot;\n&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span class="hs-comment">{- $inputfncs
The following functions read one line or character of input from the user.

When using terminal-style interaction, these functions return 'Nothing' if the user
pressed @Ctrl-D@ when the input text was empty.

When using file-style interaction, these functions return 'Nothing' if
an @EOF@ was encountered before any characters were read.
-}</span><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span class="hs-comment">{- | Reads one line of input.  The final newline (if any) is removed.  When using terminal-style interaction, this function provides a rich line-editing user interface.

If @'autoAddHistory' == 'True'@ and the line input is nonblank (i.e., is not all
spaces), it will be automatically added to the history.
-}</span><span>
</span><a name="line-144"></a><span class="hs-identifier">getInputLine</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Haskeline.MonadException.html#MonadException"><span class="hs-identifier hs-type">MonadException</span></a><span> </span><a href="#local-6989586621679092741"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-comment">-- ^ The input prompt</span><span>
</span><a name="line-145"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.Haskeline.InputT.html#InputT"><span class="hs-identifier hs-type">InputT</span></a><span> </span><a href="#local-6989586621679092741"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">)</span><span>
</span><a name="line-146"></a><a name="getInputLine"><a href="System.Console.Haskeline.html#getInputLine"><span class="hs-identifier">getInputLine</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Haskeline.html#promptedInput"><span class="hs-identifier hs-var">promptedInput</span></a><span> </span><span class="hs-special">(</span><a href="System.Console.Haskeline.html#getInputCmdLine"><span class="hs-identifier hs-var">getInputCmdLine</span></a><span> </span><a href="System.Console.Haskeline.LineState.html#emptyIM"><span class="hs-identifier hs-var">emptyIM</span></a><span class="hs-special">)</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-identifier">runMaybeT</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">getLocaleLine</span><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-comment">{- | Reads one line of input and fills the insertion space with initial text. When using
terminal-style interaction, this function provides a rich line-editing user interface with the
added ability to give the user default values.

This function behaves in the exact same manner as 'getInputLine', except that
it pre-populates the input area. The text that resides in the input area is given as a 2-tuple
with two 'String's.   The string on the left of the tuple (obtained by calling 'fst') is
what will appear to the left of the cursor and the string on the right (obtained by
calling 'snd') is what will appear to the right of the cursor.

Some examples of calling of this function are:

&gt; getInputLineWithInitial &quot;prompt&gt; &quot; (&quot;left&quot;, &quot;&quot;) -- The cursor starts at the end of the line.
&gt; getInputLineWithInitial &quot;prompt&gt; &quot; (&quot;left &quot;, &quot;right&quot;) -- The cursor starts before the second word.
 -}</span><span>
</span><a name="line-163"></a><span class="hs-identifier">getInputLineWithInitial</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Haskeline.MonadException.html#MonadException"><span class="hs-identifier hs-type">MonadException</span></a><span> </span><a href="#local-6989586621679092740"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-164"></a><span>                            </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>           </span><span class="hs-comment">-- ^ The input prompt</span><span>
</span><a name="line-165"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">,</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ The initial value left and right of the cursor</span><span>
</span><a name="line-166"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.Haskeline.InputT.html#InputT"><span class="hs-identifier hs-type">InputT</span></a><span> </span><a href="#local-6989586621679092740"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">)</span><span>
</span><a name="line-167"></a><a name="getInputLineWithInitial"><a href="System.Console.Haskeline.html#getInputLineWithInitial"><span class="hs-identifier">getInputLineWithInitial</span></a></a><span> </span><a name="local-6989586621679092747"><a href="#local-6989586621679092747"><span class="hs-identifier">prompt</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679092748"><a href="#local-6989586621679092748"><span class="hs-identifier">left</span></a></a><span class="hs-special">,</span><a name="local-6989586621679092749"><a href="#local-6989586621679092749"><span class="hs-identifier">right</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Haskeline.html#promptedInput"><span class="hs-identifier hs-var">promptedInput</span></a><span> </span><span class="hs-special">(</span><a href="System.Console.Haskeline.html#getInputCmdLine"><span class="hs-identifier hs-var">getInputCmdLine</span></a><span> </span><a href="#local-6989586621679092750"><span class="hs-identifier hs-var">initialIM</span></a><span class="hs-special">)</span><span>
</span><a name="line-168"></a><span>                                                </span><span class="hs-special">(</span><span class="hs-identifier">runMaybeT</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-identifier">getLocaleLine</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679092747"><span class="hs-identifier hs-var">prompt</span></a><span>
</span><a name="line-169"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-170"></a><span>    </span><a name="local-6989586621679092750"><a href="#local-6989586621679092750"><span class="hs-identifier">initialIM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Haskeline.LineState.html#insertString"><span class="hs-identifier hs-var">insertString</span></a><span> </span><a href="#local-6989586621679092748"><span class="hs-identifier hs-var">left</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="System.Console.Haskeline.LineState.html#moveToStart"><span class="hs-identifier hs-var">moveToStart</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="System.Console.Haskeline.LineState.html#insertString"><span class="hs-identifier hs-var">insertString</span></a><span> </span><a href="#local-6989586621679092749"><span class="hs-identifier hs-var">right</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="System.Console.Haskeline.LineState.html#emptyIM"><span class="hs-identifier hs-var">emptyIM</span></a><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span class="hs-identifier">getInputCmdLine</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Haskeline.MonadException.html#MonadException"><span class="hs-identifier hs-type">MonadException</span></a><span> </span><a href="#local-6989586621679092739"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Haskeline.LineState.html#InsertMode"><span class="hs-identifier hs-type">InsertMode</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.Haskeline.Term.html#TermOps"><span class="hs-identifier hs-type">TermOps</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.Haskeline.InputT.html#InputT"><span class="hs-identifier hs-type">InputT</span></a><span> </span><a href="#local-6989586621679092739"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">)</span><span>
</span><a name="line-173"></a><a name="getInputCmdLine"><a href="System.Console.Haskeline.html#getInputCmdLine"><span class="hs-identifier">getInputCmdLine</span></a></a><span> </span><a name="local-6989586621679092751"><a href="#local-6989586621679092751"><span class="hs-identifier">initialIM</span></a></a><span> </span><a name="local-6989586621679092752"><a href="#local-6989586621679092752"><span class="hs-identifier">tops</span></a></a><span> </span><a name="local-6989586621679092753"><a href="#local-6989586621679092753"><span class="hs-identifier">prefix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-174"></a><span>    </span><a name="local-6989586621679092754"><a href="#local-6989586621679092754"><span class="hs-identifier">emode</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Console.Haskeline.InputT.html#InputT"><span class="hs-identifier hs-var">InputT</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="System.Console.Haskeline.Monads.html#asks"><span class="hs-identifier hs-var">asks</span></a><span> </span><span class="hs-identifier">editMode</span><span>
</span><a name="line-175"></a><span>    </span><a name="local-6989586621679092755"><a href="#local-6989586621679092755"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Console.Haskeline.InputT.html#runInputCmdT"><span class="hs-identifier hs-var">runInputCmdT</span></a><span> </span><a href="#local-6989586621679092752"><span class="hs-identifier hs-var">tops</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679092754"><span class="hs-identifier hs-var">emode</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-176"></a><span>                </span><a href="System.Console.Haskeline.Prefs.html#Emacs"><span class="hs-identifier hs-var">Emacs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.Haskeline.RunCommand.html#runCommandLoop"><span class="hs-identifier hs-var">runCommandLoop</span></a><span> </span><a href="#local-6989586621679092752"><span class="hs-identifier hs-var">tops</span></a><span> </span><a href="#local-6989586621679092753"><span class="hs-identifier hs-var">prefix</span></a><span> </span><a href="System.Console.Haskeline.Emacs.html#emacsCommands"><span class="hs-identifier hs-var">emacsCommands</span></a><span> </span><a href="#local-6989586621679092751"><span class="hs-identifier hs-var">initialIM</span></a><span>
</span><a name="line-177"></a><span>                </span><a href="System.Console.Haskeline.Prefs.html#Vi"><span class="hs-identifier hs-var">Vi</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.Haskeline.Monads.html#evalStateT%27"><span class="hs-identifier hs-var">evalStateT'</span></a><span> </span><a href="System.Console.Haskeline.Vi.html#emptyViState"><span class="hs-identifier hs-var">emptyViState</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>
</span><a name="line-178"></a><span>                        </span><a href="System.Console.Haskeline.RunCommand.html#runCommandLoop"><span class="hs-identifier hs-var">runCommandLoop</span></a><span> </span><a href="#local-6989586621679092752"><span class="hs-identifier hs-var">tops</span></a><span> </span><a href="#local-6989586621679092753"><span class="hs-identifier hs-var">prefix</span></a><span> </span><a href="System.Console.Haskeline.Vi.html#viKeyCommands"><span class="hs-identifier hs-var">viKeyCommands</span></a><span> </span><a href="#local-6989586621679092751"><span class="hs-identifier hs-var">initialIM</span></a><span>
</span><a name="line-179"></a><span>    </span><a href="System.Console.Haskeline.html#maybeAddHistory"><span class="hs-identifier hs-var">maybeAddHistory</span></a><span> </span><a href="#local-6989586621679092755"><span class="hs-identifier hs-var">result</span></a><span>
</span><a name="line-180"></a><span>    </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679092755"><span class="hs-identifier hs-var">result</span></a><span>
</span><a name="line-181"></a><span>
</span><a name="line-182"></a><span class="hs-identifier">maybeAddHistory</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679092738"><a href="#local-6989586621679092738"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a><span> </span><a href="#local-6989586621679092738"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.Haskeline.InputT.html#InputT"><span class="hs-identifier hs-type">InputT</span></a><span> </span><a href="#local-6989586621679092738"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-183"></a><a name="maybeAddHistory"><a href="System.Console.Haskeline.html#maybeAddHistory"><span class="hs-identifier">maybeAddHistory</span></a></a><span> </span><a name="local-6989586621679092756"><a href="#local-6989586621679092756"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-184"></a><span>    </span><a name="local-6989586621679092757"><a href="#local-6989586621679092757"><span class="hs-identifier">settings</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Haskeline.InputT.html#Settings"><span class="hs-identifier hs-type">Settings</span></a><span> </span><a href="#local-6989586621679092738"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Console.Haskeline.InputT.html#InputT"><span class="hs-identifier hs-var">InputT</span></a><span> </span><a href="System.Console.Haskeline.Monads.html#ask"><span class="hs-identifier hs-var">ask</span></a><span>
</span><a name="line-185"></a><span>    </span><a name="local-6989586621679092758"><a href="#local-6989586621679092758"><span class="hs-identifier">histDupes</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Console.Haskeline.InputT.html#InputT"><span class="hs-identifier hs-var">InputT</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="System.Console.Haskeline.Monads.html#asks"><span class="hs-identifier hs-var">asks</span></a><span> </span><span class="hs-identifier">historyDuplicates</span><span>
</span><a name="line-186"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679092756"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-187"></a><span>        </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a name="local-6989586621679092759"><a href="#local-6989586621679092759"><span class="hs-identifier">line</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">autoAddHistory</span><span> </span><a href="#local-6989586621679092757"><span class="hs-identifier hs-var">settings</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Unicode.html#isSpace"><span class="hs-identifier hs-var">isSpace</span></a><span> </span><a href="#local-6989586621679092759"><span class="hs-identifier hs-var">line</span></a><span class="hs-special">)</span><span>
</span><a name="line-188"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679092760"><a href="#local-6989586621679092760"><span class="hs-identifier">adder</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679092758"><span class="hs-identifier hs-var">histDupes</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-189"></a><span>                        </span><a href="System.Console.Haskeline.Prefs.html#AlwaysAdd"><span class="hs-identifier hs-var">AlwaysAdd</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.Haskeline.History.html#addHistory"><span class="hs-identifier hs-var">addHistory</span></a><span>
</span><a name="line-190"></a><span>                        </span><a href="System.Console.Haskeline.Prefs.html#IgnoreConsecutive"><span class="hs-identifier hs-var">IgnoreConsecutive</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.Haskeline.History.html#addHistoryUnlessConsecutiveDupe"><span class="hs-identifier hs-var">addHistoryUnlessConsecutiveDupe</span></a><span>
</span><a name="line-191"></a><span>                        </span><a href="System.Console.Haskeline.Prefs.html#IgnoreAll"><span class="hs-identifier hs-var">IgnoreAll</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.Haskeline.History.html#addHistoryRemovingAllDupes"><span class="hs-identifier hs-var">addHistoryRemovingAllDupes</span></a><span>
</span><a name="line-192"></a><span>               </span><span class="hs-keyword">in</span><span> </span><a href="System.Console.Haskeline.InputT.html#modifyHistory"><span class="hs-identifier hs-var">modifyHistory</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679092760"><span class="hs-identifier hs-var">adder</span></a><span> </span><a href="#local-6989586621679092759"><span class="hs-identifier hs-var">line</span></a><span class="hs-special">)</span><span>
</span><a name="line-193"></a><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-194"></a><span>
</span><a name="line-195"></a><span class="hs-comment">----------</span><span>
</span><a name="line-196"></a><span>
</span><a name="line-197"></a><span class="hs-comment">{- | Reads one character of input.  Ignores non-printable characters.

When using terminal-style interaction, the character will be read without waiting
for a newline.

When using file-style interaction, a newline will be read if it is immediately
available after the input character.
-}</span><span>
</span><a name="line-205"></a><span class="hs-identifier">getInputChar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Haskeline.MonadException.html#MonadException"><span class="hs-identifier hs-type">MonadException</span></a><span> </span><a href="#local-6989586621679092737"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-comment">-- ^ The input prompt</span><span>
</span><a name="line-206"></a><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.Haskeline.InputT.html#InputT"><span class="hs-identifier hs-type">InputT</span></a><span> </span><a href="#local-6989586621679092737"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-identifier hs-type">Char</span><span class="hs-special">)</span><span>
</span><a name="line-207"></a><a name="getInputChar"><a href="System.Console.Haskeline.html#getInputChar"><span class="hs-identifier">getInputChar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Haskeline.html#promptedInput"><span class="hs-identifier hs-var">promptedInput</span></a><span> </span><a href="System.Console.Haskeline.html#getInputCmdChar"><span class="hs-identifier hs-var">getInputCmdChar</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679092761"><a href="#local-6989586621679092761"><span class="hs-identifier">fops</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-208"></a><span>                        </span><a name="local-6989586621679092762"><a href="#local-6989586621679092762"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Console.Haskeline.html#getPrintableChar"><span class="hs-identifier hs-var">getPrintableChar</span></a><span> </span><a href="#local-6989586621679092761"><span class="hs-identifier hs-var">fops</span></a><span>
</span><a name="line-209"></a><span>                        </span><span class="hs-identifier">maybeReadNewline</span><span> </span><a href="#local-6989586621679092761"><span class="hs-identifier hs-var">fops</span></a><span>
</span><a name="line-210"></a><span>                        </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679092762"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-211"></a><span>
</span><a name="line-212"></a><span class="hs-identifier">getPrintableChar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Haskeline.Term.html#FileOps"><span class="hs-identifier hs-type">FileOps</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-identifier hs-type">Char</span><span class="hs-special">)</span><span>
</span><a name="line-213"></a><a name="getPrintableChar"><a href="System.Console.Haskeline.html#getPrintableChar"><span class="hs-identifier">getPrintableChar</span></a></a><span> </span><a name="local-6989586621679092763"><a href="#local-6989586621679092763"><span class="hs-identifier">fops</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-214"></a><span>    </span><a name="local-6989586621679092764"><a href="#local-6989586621679092764"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">runMaybeT</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-identifier">getLocaleChar</span><span> </span><a href="#local-6989586621679092763"><span class="hs-identifier hs-var">fops</span></a><span>
</span><a name="line-215"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Unicode.html#isPrint"><span class="hs-identifier hs-var">isPrint</span></a><span> </span><a href="#local-6989586621679092764"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-216"></a><span>        </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.Haskeline.html#getPrintableChar"><span class="hs-identifier hs-var">getPrintableChar</span></a><span> </span><a href="#local-6989586621679092763"><span class="hs-identifier hs-var">fops</span></a><span>
</span><a name="line-217"></a><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679092764"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span class="hs-identifier">getInputCmdChar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Haskeline.MonadException.html#MonadException"><span class="hs-identifier hs-type">MonadException</span></a><span> </span><a href="#local-6989586621679092736"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Haskeline.Term.html#TermOps"><span class="hs-identifier hs-type">TermOps</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.Haskeline.InputT.html#InputT"><span class="hs-identifier hs-type">InputT</span></a><span> </span><a href="#local-6989586621679092736"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-identifier hs-type">Char</span><span class="hs-special">)</span><span>
</span><a name="line-220"></a><a name="getInputCmdChar"><a href="System.Console.Haskeline.html#getInputCmdChar"><span class="hs-identifier">getInputCmdChar</span></a></a><span> </span><a name="local-6989586621679092765"><a href="#local-6989586621679092765"><span class="hs-identifier">tops</span></a></a><span> </span><a name="local-6989586621679092766"><a href="#local-6989586621679092766"><span class="hs-identifier">prefix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Haskeline.InputT.html#runInputCmdT"><span class="hs-identifier hs-var">runInputCmdT</span></a><span> </span><a href="#local-6989586621679092765"><span class="hs-identifier hs-var">tops</span></a><span>
</span><a name="line-221"></a><span>        </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="System.Console.Haskeline.RunCommand.html#runCommandLoop"><span class="hs-identifier hs-var">runCommandLoop</span></a><span> </span><a href="#local-6989586621679092765"><span class="hs-identifier hs-var">tops</span></a><span> </span><a href="#local-6989586621679092766"><span class="hs-identifier hs-var">prefix</span></a><span> </span><a href="System.Console.Haskeline.html#acceptOneChar"><span class="hs-identifier hs-var">acceptOneChar</span></a><span> </span><a href="System.Console.Haskeline.LineState.html#emptyIM"><span class="hs-identifier hs-var">emptyIM</span></a><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span class="hs-identifier">acceptOneChar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="#local-6989586621679092735"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Haskeline.Command.html#KeyCommand"><span class="hs-identifier hs-type">KeyCommand</span></a><span> </span><a href="#local-6989586621679092735"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="System.Console.Haskeline.LineState.html#InsertMode"><span class="hs-identifier hs-type">InsertMode</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-identifier hs-type">Char</span><span class="hs-special">)</span><span>
</span><a name="line-224"></a><a name="acceptOneChar"><a href="System.Console.Haskeline.html#acceptOneChar"><span class="hs-identifier">acceptOneChar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Haskeline.Command.html#choiceCmd"><span class="hs-identifier hs-var">choiceCmd</span></a><span> </span><span class="hs-special">[</span><a href="System.Console.Haskeline.Command.html#useChar"><span class="hs-identifier hs-var">useChar</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679092767"><a href="#local-6989586621679092767"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679092768"><a href="#local-6989586621679092768"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.Haskeline.Command.html#change"><span class="hs-identifier hs-var">change</span></a><span> </span><span class="hs-special">(</span><a href="System.Console.Haskeline.LineState.html#insertChar"><span class="hs-identifier hs-var">insertChar</span></a><span> </span><a href="#local-6989586621679092767"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679092768"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-225"></a><span>                                                </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679092767"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-226"></a><span>                          </span><span class="hs-special">,</span><span> </span><a href="System.Console.Haskeline.Key.html#ctrlChar"><span class="hs-identifier hs-var">ctrlChar</span></a><span> </span><span class="hs-char">'l'</span><span> </span><a href="System.Console.Haskeline.Command.html#%2B%3E"><span class="hs-operator hs-var">+&gt;</span></a><span> </span><a href="System.Console.Haskeline.Command.html#clearScreenCmd"><span class="hs-identifier hs-var">clearScreenCmd</span></a><span> </span><a href="System.Console.Haskeline.Command.html#%3E%7C%3E"><span class="hs-operator hs-var">&gt;|&gt;</span></a><span>
</span><a name="line-227"></a><span>                                        </span><a href="System.Console.Haskeline.Command.html#keyCommand"><span class="hs-identifier hs-var">keyCommand</span></a><span> </span><a href="System.Console.Haskeline.html#acceptOneChar"><span class="hs-identifier hs-var">acceptOneChar</span></a><span>
</span><a name="line-228"></a><span>                          </span><span class="hs-special">,</span><span> </span><a href="System.Console.Haskeline.Key.html#ctrlChar"><span class="hs-identifier hs-var">ctrlChar</span></a><span> </span><span class="hs-char">'d'</span><span> </span><a href="System.Console.Haskeline.Command.html#%2B%3E"><span class="hs-operator hs-var">+&gt;</span></a><span> </span><a href="System.Console.Haskeline.Command.html#failCmd"><span class="hs-identifier hs-var">failCmd</span></a><span class="hs-special">]</span><span>
</span><a name="line-229"></a><span>
</span><a name="line-230"></a><span class="hs-comment">----------</span><span>
</span><a name="line-231"></a><span class="hs-comment">-- Passwords</span><span>
</span><a name="line-232"></a><span>
</span><a name="line-233"></a><span class="hs-comment">{- | Reads one line of input, without displaying the input while it is being typed.
When using terminal-style interaction, the masking character (if given) will replace each typed character.

When using file-style interaction, this function turns off echoing while reading
the line of input.

Note that if Haskeline is built against a version of the @Win32@ library
earlier than 2.5, 'getPassword' will incorrectly echo back input on MinTTY
consoles (such as Cygwin or MSYS).
-}</span><span>
</span><a name="line-243"></a><span>
</span><a name="line-244"></a><span class="hs-identifier">getPassword</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Haskeline.MonadException.html#MonadException"><span class="hs-identifier hs-type">MonadException</span></a><span> </span><a href="#local-6989586621679092734"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-comment">-- ^ A masking character; e.g., @Just \'*\'@</span><span>
</span><a name="line-245"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.Haskeline.InputT.html#InputT"><span class="hs-identifier hs-type">InputT</span></a><span> </span><a href="#local-6989586621679092734"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">)</span><span>
</span><a name="line-246"></a><a name="getPassword"><a href="System.Console.Haskeline.html#getPassword"><span class="hs-identifier">getPassword</span></a></a><span> </span><a name="local-6989586621679092769"><a href="#local-6989586621679092769"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Haskeline.html#promptedInput"><span class="hs-identifier hs-var">promptedInput</span></a><span>
</span><a name="line-247"></a><span>                    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679092774"><a href="#local-6989586621679092774"><span class="hs-identifier">tops</span></a></a><span> </span><a name="local-6989586621679092775"><a href="#local-6989586621679092775"><span class="hs-identifier">prefix</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.Haskeline.InputT.html#runInputCmdT"><span class="hs-identifier hs-var">runInputCmdT</span></a><span> </span><a href="#local-6989586621679092774"><span class="hs-identifier hs-var">tops</span></a><span>
</span><a name="line-248"></a><span>                                        </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="System.Console.Haskeline.RunCommand.html#runCommandLoop"><span class="hs-identifier hs-var">runCommandLoop</span></a><span> </span><a href="#local-6989586621679092774"><span class="hs-identifier hs-var">tops</span></a><span> </span><a href="#local-6989586621679092775"><span class="hs-identifier hs-var">prefix</span></a><span> </span><a href="#local-6989586621679092770"><span class="hs-identifier hs-var">loop</span></a><span>
</span><a name="line-249"></a><span>                                        </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="System.Console.Haskeline.LineState.html#Password"><span class="hs-identifier hs-var">Password</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679092769"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-250"></a><span>                    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679092776"><a href="#local-6989586621679092776"><span class="hs-identifier">fops</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">withoutInputEcho</span><span> </span><a href="#local-6989586621679092776"><span class="hs-identifier hs-var">fops</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-identifier">runMaybeT</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-identifier">getLocaleLine</span><span> </span><a href="#local-6989586621679092776"><span class="hs-identifier hs-var">fops</span></a><span class="hs-special">)</span><span>
</span><a name="line-251"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-252"></a><span>    </span><a name="local-6989586621679092770"><a href="#local-6989586621679092770"><span class="hs-identifier">loop</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Haskeline.Command.html#choiceCmd"><span class="hs-identifier hs-var">choiceCmd</span></a><span> </span><span class="hs-special">[</span><span> </span><a href="System.Console.Haskeline.Key.html#simpleChar"><span class="hs-identifier hs-var">simpleChar</span></a><span> </span><span class="hs-char">'\n'</span><span> </span><a href="System.Console.Haskeline.Command.html#%2B%3E"><span class="hs-operator hs-var">+&gt;</span></a><span> </span><a href="System.Console.Haskeline.Command.html#finish"><span class="hs-identifier hs-var">finish</span></a><span>
</span><a name="line-253"></a><span>                     </span><span class="hs-special">,</span><span> </span><a href="System.Console.Haskeline.Key.html#simpleKey"><span class="hs-identifier hs-var">simpleKey</span></a><span> </span><a href="System.Console.Haskeline.Key.html#Backspace"><span class="hs-identifier hs-var">Backspace</span></a><span> </span><a href="System.Console.Haskeline.Command.html#%2B%3E"><span class="hs-operator hs-var">+&gt;</span></a><span> </span><a href="System.Console.Haskeline.Command.html#change"><span class="hs-identifier hs-var">change</span></a><span> </span><a href="System.Console.Haskeline.LineState.html#deletePasswordChar"><span class="hs-identifier hs-var">deletePasswordChar</span></a><span>
</span><a name="line-254"></a><span>                                                </span><a href="System.Console.Haskeline.Command.html#%3E%7C%3E"><span class="hs-operator hs-var">&gt;|&gt;</span></a><span> </span><a href="#local-6989586621679092771"><span class="hs-identifier hs-var">loop'</span></a><span>
</span><a name="line-255"></a><span>                     </span><span class="hs-special">,</span><span> </span><a href="System.Console.Haskeline.Command.html#useChar"><span class="hs-identifier hs-var">useChar</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679092772"><a href="#local-6989586621679092772"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.Haskeline.Command.html#change"><span class="hs-identifier hs-var">change</span></a><span> </span><span class="hs-special">(</span><a href="System.Console.Haskeline.LineState.html#addPasswordChar"><span class="hs-identifier hs-var">addPasswordChar</span></a><span> </span><a href="#local-6989586621679092772"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="System.Console.Haskeline.Command.html#%3E%7C%3E"><span class="hs-operator hs-var">&gt;|&gt;</span></a><span> </span><a href="#local-6989586621679092771"><span class="hs-identifier hs-var">loop'</span></a><span>
</span><a name="line-256"></a><span>                     </span><span class="hs-special">,</span><span> </span><a href="System.Console.Haskeline.Key.html#ctrlChar"><span class="hs-identifier hs-var">ctrlChar</span></a><span> </span><span class="hs-char">'d'</span><span> </span><a href="System.Console.Haskeline.Command.html#%2B%3E"><span class="hs-operator hs-var">+&gt;</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679092773"><a href="#local-6989586621679092773"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">passwordState</span><span> </span><a href="#local-6989586621679092773"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-257"></a><span>                                                </span><span class="hs-keyword">then</span><span> </span><a href="System.Console.Haskeline.Command.html#failCmd"><span class="hs-identifier hs-var">failCmd</span></a><span> </span><a href="#local-6989586621679092773"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-258"></a><span>                                                </span><span class="hs-keyword">else</span><span> </span><a href="System.Console.Haskeline.Command.html#finish"><span class="hs-identifier hs-var">finish</span></a><span> </span><a href="#local-6989586621679092773"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-259"></a><span>                     </span><span class="hs-special">,</span><span> </span><a href="System.Console.Haskeline.Key.html#ctrlChar"><span class="hs-identifier hs-var">ctrlChar</span></a><span> </span><span class="hs-char">'l'</span><span> </span><a href="System.Console.Haskeline.Command.html#%2B%3E"><span class="hs-operator hs-var">+&gt;</span></a><span> </span><a href="System.Console.Haskeline.Command.html#clearScreenCmd"><span class="hs-identifier hs-var">clearScreenCmd</span></a><span> </span><a href="System.Console.Haskeline.Command.html#%3E%7C%3E"><span class="hs-operator hs-var">&gt;|&gt;</span></a><span> </span><a href="#local-6989586621679092771"><span class="hs-identifier hs-var">loop'</span></a><span>
</span><a name="line-260"></a><span>                     </span><span class="hs-special">]</span><span>
</span><a name="line-261"></a><span>    </span><a name="local-6989586621679092771"><a href="#local-6989586621679092771"><span class="hs-identifier">loop'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Haskeline.Command.html#keyCommand"><span class="hs-identifier hs-var">keyCommand</span></a><span> </span><a href="#local-6989586621679092770"><span class="hs-identifier hs-var">loop</span></a><span>
</span><a name="line-262"></a><span>
</span><a name="line-263"></a><span class="hs-comment">{- $history
The 'InputT' monad transformer provides direct, low-level access to the user's line history state.

However, for most applications, it should suffice to just use the 'autoAddHistory'
and 'historyFile' flags.

-}</span><span>
</span><a name="line-270"></a><span>
</span><a name="line-271"></a><span>
</span><a name="line-272"></a><span class="hs-comment">-------</span><span>
</span><a name="line-273"></a><span class="hs-comment">-- | Wrapper for input functions.</span><span>
</span><a name="line-274"></a><span class="hs-comment">-- This is the function that calls &quot;wrapFileInput&quot; around file backend input</span><span>
</span><a name="line-275"></a><span class="hs-comment">-- functions (see Term.hs).</span><span>
</span><a name="line-276"></a><span class="hs-identifier">promptedInput</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a><span> </span><a href="#local-6989586621679092732"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="System.Console.Haskeline.Term.html#TermOps"><span class="hs-identifier hs-type">TermOps</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.Haskeline.InputT.html#InputT"><span class="hs-identifier hs-type">InputT</span></a><span> </span><a href="#local-6989586621679092732"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679092733"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-277"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="System.Console.Haskeline.Term.html#FileOps"><span class="hs-identifier hs-type">FileOps</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679092733"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-278"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.Haskeline.InputT.html#InputT"><span class="hs-identifier hs-type">InputT</span></a><span> </span><a href="#local-6989586621679092732"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679092733"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-279"></a><a name="promptedInput"><a href="System.Console.Haskeline.html#promptedInput"><span class="hs-identifier">promptedInput</span></a></a><span> </span><a name="local-6989586621679092777"><a href="#local-6989586621679092777"><span class="hs-identifier">doTerm</span></a></a><span> </span><a name="local-6989586621679092778"><a href="#local-6989586621679092778"><span class="hs-identifier">doFile</span></a></a><span> </span><a name="local-6989586621679092779"><a href="#local-6989586621679092779"><span class="hs-identifier">prompt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-280"></a><span>    </span><span class="hs-comment">-- If other parts of the program have written text, make sure that it</span><span>
</span><a name="line-281"></a><span>    </span><span class="hs-comment">-- appears before we interact with the user on the terminal.</span><span>
</span><a name="line-282"></a><span>    </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Handle.html#hFlush"><span class="hs-identifier hs-var">hFlush</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.IO.Handle.FD.html#stdout"><span class="hs-identifier hs-var">stdout</span></a><span>
</span><a name="line-283"></a><span>    </span><a name="local-6989586621679092780"><a href="#local-6989586621679092780"><span class="hs-identifier">rterm</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Console.Haskeline.InputT.html#InputT"><span class="hs-identifier hs-var">InputT</span></a><span> </span><a href="System.Console.Haskeline.Monads.html#ask"><span class="hs-identifier hs-var">ask</span></a><span>
</span><a name="line-284"></a><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">termOps</span><span> </span><a href="#local-6989586621679092780"><span class="hs-identifier hs-var">rterm</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-285"></a><span>        </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><a name="local-6989586621679092781"><a href="#local-6989586621679092781"><span class="hs-identifier">fops</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-286"></a><span>                        </span><span class="hs-identifier">putStrOut</span><span> </span><a href="#local-6989586621679092780"><span class="hs-identifier hs-var">rterm</span></a><span> </span><a href="#local-6989586621679092779"><span class="hs-identifier hs-var">prompt</span></a><span>
</span><a name="line-287"></a><span>                        </span><span class="hs-identifier">wrapFileInput</span><span> </span><a href="#local-6989586621679092781"><span class="hs-identifier hs-var">fops</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-6989586621679092778"><span class="hs-identifier hs-var">doFile</span></a><span> </span><a href="#local-6989586621679092781"><span class="hs-identifier hs-var">fops</span></a><span>
</span><a name="line-288"></a><span>        </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a name="local-6989586621679092782"><a href="#local-6989586621679092782"><span class="hs-identifier">tops</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-289"></a><span>            </span><span class="hs-comment">-- If the prompt contains newlines, print all but the last line.</span><span>
</span><a name="line-290"></a><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679092783"><a href="#local-6989586621679092783"><span class="hs-identifier">lastLine</span></a></a><span class="hs-special">,</span><a name="local-6989586621679092784"><a href="#local-6989586621679092784"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#break"><span class="hs-identifier hs-var">break</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/Data.Foldable.html#elem"><span class="hs-identifier hs-var">elem</span></a><span class="hs-special">`</span><span> </span><span class="hs-string">&quot;\r\n&quot;</span><span class="hs-special">)</span><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-6989586621679092779"><span class="hs-identifier hs-var">prompt</span></a><span>
</span><a name="line-291"></a><span>            </span><a href="System.Console.Haskeline.html#outputStr"><span class="hs-identifier hs-var">outputStr</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-6989586621679092784"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-292"></a><span>            </span><a href="#local-6989586621679092777"><span class="hs-identifier hs-var">doTerm</span></a><span> </span><a href="#local-6989586621679092782"><span class="hs-identifier hs-var">tops</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-6989586621679092783"><span class="hs-identifier hs-var">lastLine</span></a><span>
</span><a name="line-293"></a><span>
</span><a name="line-294"></a><span class="hs-comment">{- | If Ctrl-C is pressed during the given action, throw an exception
of type 'Interrupt'.  For example:

&gt; tryAction :: InputT IO ()
&gt; tryAction = handle (\Interrupt -&gt; outputStrLn &quot;Cancelled.&quot;)
&gt;                $ withInterrupt $ someLongAction

The action can handle the interrupt itself; a new 'Interrupt' exception will be thrown
every time Ctrl-C is pressed.

&gt; tryAction :: InputT IO ()
&gt; tryAction = withInterrupt loop
&gt;     where loop = handle (\Interrupt -&gt; outputStrLn &quot;Cancelled; try again.&quot; &gt;&gt; loop)
&gt;                    someLongAction

This behavior differs from GHC's built-in Ctrl-C handling, which
may immediately terminate the program after the second time that the user presses
Ctrl-C.

-}</span><span>
</span><a name="line-314"></a><span class="hs-identifier">withInterrupt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Haskeline.MonadException.html#MonadException"><span class="hs-identifier hs-type">MonadException</span></a><span> </span><a href="#local-6989586621679092730"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Haskeline.InputT.html#InputT"><span class="hs-identifier hs-type">InputT</span></a><span> </span><a href="#local-6989586621679092730"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679092731"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.Haskeline.InputT.html#InputT"><span class="hs-identifier hs-type">InputT</span></a><span> </span><a href="#local-6989586621679092730"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679092731"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-315"></a><a name="withInterrupt"><a href="System.Console.Haskeline.html#withInterrupt"><span class="hs-identifier">withInterrupt</span></a></a><span> </span><a name="local-6989586621679092785"><a href="#local-6989586621679092785"><span class="hs-identifier">act</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-316"></a><span>    </span><a name="local-6989586621679092786"><a href="#local-6989586621679092786"><span class="hs-identifier">rterm</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Console.Haskeline.InputT.html#InputT"><span class="hs-identifier hs-var">InputT</span></a><span> </span><a href="System.Console.Haskeline.Monads.html#ask"><span class="hs-identifier hs-var">ask</span></a><span>
</span><a name="line-317"></a><span>    </span><a href="System.Console.Haskeline.MonadException.html#liftIOOp_"><span class="hs-identifier hs-var">liftIOOp_</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">wrapInterrupt</span><span> </span><a href="#local-6989586621679092786"><span class="hs-identifier hs-var">rterm</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679092785"><span class="hs-identifier hs-var">act</span></a><span>
</span><a name="line-318"></a><span>
</span><a name="line-319"></a><span class="hs-comment">-- | Catch and handle an exception of type 'Interrupt'.</span><span>
</span><a name="line-320"></a><span class="hs-comment">--</span><span>
</span><a name="line-321"></a><span class="hs-comment">-- &gt; handleInterrupt f = handle $ \Interrupt -&gt; f</span><span>
</span><a name="line-322"></a><span class="hs-identifier">handleInterrupt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Haskeline.MonadException.html#MonadException"><span class="hs-identifier hs-type">MonadException</span></a><span> </span><a href="#local-6989586621679092728"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679092728"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679092729"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679092728"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679092729"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679092728"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679092729"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-323"></a><a name="handleInterrupt"><a href="System.Console.Haskeline.html#handleInterrupt"><span class="hs-identifier">handleInterrupt</span></a></a><span> </span><a name="local-6989586621679092787"><a href="#local-6989586621679092787"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Haskeline.MonadException.html#handle"><span class="hs-identifier hs-var">handle</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a href="System.Console.Haskeline.Term.html#Interrupt"><span class="hs-identifier hs-var">Interrupt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679092787"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-324"></a><span>
</span><a name="line-325"></a><span class="hs-comment">{- | Return a printing function, which in terminal-style interactions is
thread-safe and may be run concurrently with user input without affecting the
prompt. -}</span><span>
</span><a name="line-328"></a><span class="hs-identifier">getExternalPrint</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Haskeline.MonadException.html#MonadException"><span class="hs-identifier hs-type">MonadException</span></a><span> </span><a href="#local-6989586621679092727"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Haskeline.InputT.html#InputT"><span class="hs-identifier hs-type">InputT</span></a><span> </span><a href="#local-6989586621679092727"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-329"></a><a name="getExternalPrint"><a href="System.Console.Haskeline.html#getExternalPrint"><span class="hs-identifier">getExternalPrint</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-330"></a><span>    </span><a name="local-6989586621679092788"><a href="#local-6989586621679092788"><span class="hs-identifier">rterm</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Console.Haskeline.InputT.html#InputT"><span class="hs-identifier hs-var">InputT</span></a><span> </span><a href="System.Console.Haskeline.Monads.html#ask"><span class="hs-identifier hs-var">ask</span></a><span>
</span><a name="line-331"></a><span>    </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">termOps</span><span> </span><a href="#local-6989586621679092788"><span class="hs-identifier hs-var">rterm</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-332"></a><span>        </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">putStrOut</span><span> </span><a href="#local-6989586621679092788"><span class="hs-identifier hs-var">rterm</span></a><span>
</span><a name="line-333"></a><span>        </span><a href="../base-4.11.1.0/src/%{MODULE/./-}.html#%{NAME}/Data.Either.html#Left"><span class="hs-identifier hs-var">Left</span></a><span> </span><a name="local-6989586621679092789"><a href="#local-6989586621679092789"><span class="hs-identifier">tops</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">externalPrint</span><span> </span><a href="#local-6989586621679092789"><span class="hs-identifier hs-var">tops</span></a><span>
</span><a name="line-334"></a></pre></body></html>