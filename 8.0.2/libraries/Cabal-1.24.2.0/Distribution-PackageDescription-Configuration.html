<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Distribution.PackageDescription.Configuration</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Distribution-PackageDescription-Configuration.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Distribution-PackageDescription-Configuration.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">Cabal-1.24.2.0: A framework for packaging Haskell software</p></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Thomas Schilling 2007</td></tr><tr><th>License</th><td>BSD3</td></tr><tr><th>Maintainer</th><td>cabal-devel@haskell.org</td></tr><tr><th>Portability</th><td>portable</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell98</td></tr></table><p class="caption">Distribution.PackageDescription.Configuration</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This is about the cabal configurations feature. It exports
 <code><a href="Distribution-PackageDescription-Configuration.html#v:finalizePackageDescription">finalizePackageDescription</a></code> and <code><a href="Distribution-PackageDescription-Configuration.html#v:flattenPackageDescription">flattenPackageDescription</a></code> which are
 functions for converting <code><a href="Distribution-PackageDescription.html#t:GenericPackageDescription">GenericPackageDescription</a></code>s down to
 <code><a href="Distribution-PackageDescription.html#t:PackageDescription">PackageDescription</a></code>s. It has code for working with the tree of conditions
 and resolving or flattening conditions.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:finalizePackageDescription">finalizePackageDescription</a> :: <a href="Distribution-PackageDescription.html#t:FlagAssignment">FlagAssignment</a> -&gt; (<a href="Distribution-Package.html#t:Dependency">Dependency</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; <a href="Distribution-System.html#t:Platform">Platform</a> -&gt; <a href="Distribution-Compiler.html#t:CompilerInfo">CompilerInfo</a> -&gt; [<a href="Distribution-Package.html#t:Dependency">Dependency</a>] -&gt; <a href="Distribution-PackageDescription.html#t:GenericPackageDescription">GenericPackageDescription</a> -&gt; <a href="../base-4.9.1.0/Data-Either.html#t:Either">Either</a> [<a href="Distribution-Package.html#t:Dependency">Dependency</a>] (<a href="Distribution-PackageDescription.html#t:PackageDescription">PackageDescription</a>, <a href="Distribution-PackageDescription.html#t:FlagAssignment">FlagAssignment</a>)</li><li class="src short"><a href="#v:flattenPackageDescription">flattenPackageDescription</a> :: <a href="Distribution-PackageDescription.html#t:GenericPackageDescription">GenericPackageDescription</a> -&gt; <a href="Distribution-PackageDescription.html#t:PackageDescription">PackageDescription</a></li><li class="src short"><a href="#v:parseCondition">parseCondition</a> :: <a href="Distribution-Compat-ReadP.html#t:ReadP">ReadP</a> r (<a href="Distribution-PackageDescription.html#t:Condition">Condition</a> <a href="Distribution-PackageDescription.html#t:ConfVar">ConfVar</a>)</li><li class="src short"><a href="#v:freeVars">freeVars</a> :: <a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a> <a href="Distribution-PackageDescription.html#t:ConfVar">ConfVar</a> c a -&gt; [<a href="Distribution-PackageDescription.html#t:FlagName">FlagName</a>]</li><li class="src short"><a href="#v:extractCondition">extractCondition</a> :: <a href="../base-4.9.1.0/Data-Eq.html#t:Eq">Eq</a> v =&gt; (a -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; <a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a> v c a -&gt; <a href="Distribution-PackageDescription.html#t:Condition">Condition</a> v</li><li class="src short"><a href="#v:extractConditions">extractConditions</a> :: (<a href="Distribution-PackageDescription.html#t:BuildInfo">BuildInfo</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; <a href="Distribution-PackageDescription.html#t:GenericPackageDescription">GenericPackageDescription</a> -&gt; [<a href="Distribution-PackageDescription.html#t:Condition">Condition</a> <a href="Distribution-PackageDescription.html#t:ConfVar">ConfVar</a>]</li><li class="src short"><a href="#v:addBuildableCondition">addBuildableCondition</a> :: (<a href="../base-4.9.1.0/Data-Eq.html#t:Eq">Eq</a> v, <a href="Distribution-Compat-Semigroup.html#t:Monoid">Monoid</a> a, <a href="Distribution-Compat-Semigroup.html#t:Monoid">Monoid</a> c) =&gt; (a -&gt; <a href="Distribution-PackageDescription.html#t:BuildInfo">BuildInfo</a>) -&gt; <a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a> v c a -&gt; <a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a> v c a</li><li class="src short"><a href="#v:mapCondTree">mapCondTree</a> :: (a -&gt; b) -&gt; (c -&gt; d) -&gt; (<a href="Distribution-PackageDescription.html#t:Condition">Condition</a> v -&gt; <a href="Distribution-PackageDescription.html#t:Condition">Condition</a> w) -&gt; <a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a> v c a -&gt; <a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a> w d b</li><li class="src short"><a href="#v:mapTreeData">mapTreeData</a> :: (a -&gt; b) -&gt; <a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a> v c a -&gt; <a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a> v c b</li><li class="src short"><a href="#v:mapTreeConds">mapTreeConds</a> :: (<a href="Distribution-PackageDescription.html#t:Condition">Condition</a> v -&gt; <a href="Distribution-PackageDescription.html#t:Condition">Condition</a> w) -&gt; <a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a> v c a -&gt; <a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a> w c a</li><li class="src short"><a href="#v:mapTreeConstrs">mapTreeConstrs</a> :: (c -&gt; d) -&gt; <a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a> v c a -&gt; <a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a> v d a</li><li class="src short"><a href="#v:transformAllBuildInfos">transformAllBuildInfos</a> :: (<a href="Distribution-PackageDescription.html#t:BuildInfo">BuildInfo</a> -&gt; <a href="Distribution-PackageDescription.html#t:BuildInfo">BuildInfo</a>) -&gt; (<a href="Distribution-PackageDescription.html#t:SetupBuildInfo">SetupBuildInfo</a> -&gt; <a href="Distribution-PackageDescription.html#t:SetupBuildInfo">SetupBuildInfo</a>) -&gt; <a href="Distribution-PackageDescription.html#t:GenericPackageDescription">GenericPackageDescription</a> -&gt; <a href="Distribution-PackageDescription.html#t:GenericPackageDescription">GenericPackageDescription</a></li><li class="src short"><a href="#v:transformAllBuildDepends">transformAllBuildDepends</a> :: (<a href="Distribution-Package.html#t:Dependency">Dependency</a> -&gt; <a href="Distribution-Package.html#t:Dependency">Dependency</a>) -&gt; <a href="Distribution-PackageDescription.html#t:GenericPackageDescription">GenericPackageDescription</a> -&gt; <a href="Distribution-PackageDescription.html#t:GenericPackageDescription">GenericPackageDescription</a></li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:finalizePackageDescription" class="def">finalizePackageDescription</a> <a href="src/Distribution-PackageDescription-Configuration.html#finalizePackageDescription" class="link">Source</a> <a href="#v:finalizePackageDescription" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Distribution-PackageDescription.html#t:FlagAssignment">FlagAssignment</a></td><td class="doc"><p>Explicitly specified flag assignments</p></td></tr><tr><td class="src">-&gt; (<a href="Distribution-Package.html#t:Dependency">Dependency</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a>)</td><td class="doc"><p>Is a given dependency satisfiable from the set of
 available packages?  If this is unknown then use
 True.</p></td></tr><tr><td class="src">-&gt; <a href="Distribution-System.html#t:Platform">Platform</a></td><td class="doc"><p>The <code><a href="Distribution-System.html#t:Arch">Arch</a></code> and <code><a href="Distribution-System.html#t:OS">OS</a></code></p></td></tr><tr><td class="src">-&gt; <a href="Distribution-Compiler.html#t:CompilerInfo">CompilerInfo</a></td><td class="doc"><p>Compiler information</p></td></tr><tr><td class="src">-&gt; [<a href="Distribution-Package.html#t:Dependency">Dependency</a>]</td><td class="doc"><p>Additional constraints</p></td></tr><tr><td class="src">-&gt; <a href="Distribution-PackageDescription.html#t:GenericPackageDescription">GenericPackageDescription</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="../base-4.9.1.0/Data-Either.html#t:Either">Either</a> [<a href="Distribution-Package.html#t:Dependency">Dependency</a>] (<a href="Distribution-PackageDescription.html#t:PackageDescription">PackageDescription</a>, <a href="Distribution-PackageDescription.html#t:FlagAssignment">FlagAssignment</a>)</td><td class="doc"><p>Either missing dependencies or the resolved package
 description along with the flag assignments chosen.</p></td></tr></table></div><div class="doc"><p>Create a package description with all configurations resolved.</p><p>This function takes a <code><a href="Distribution-PackageDescription.html#t:GenericPackageDescription">GenericPackageDescription</a></code> and several environment
 parameters and tries to generate <code><a href="Distribution-PackageDescription.html#t:PackageDescription">PackageDescription</a></code> by finding a flag
 assignment that result in satisfiable dependencies.</p><p>It takes as inputs a not necessarily complete specifications of flags
 assignments, an optional package index as well as platform parameters.  If
 some flags are not assigned explicitly, this function will try to pick an
 assignment that causes this function to succeed.  The package index is
 optional since on some platforms we cannot determine which packages have
 been installed before.  When no package index is supplied, every dependency
 is assumed to be satisfiable, therefore all not explicitly assigned flags
 will get their default values.</p><p>This function will fail if it cannot find a flag assignment that leads to
 satisfiable dependencies.  (It will not try alternative assignments for
 explicitly specified flags.)  In case of failure it will return the missing
 dependencies that it encountered when trying different flag assignments.
 On success, it will return the package description and the full flag
 assignment chosen.</p></div></div><div class="top"><p class="src"><a id="v:flattenPackageDescription" class="def">flattenPackageDescription</a> :: <a href="Distribution-PackageDescription.html#t:GenericPackageDescription">GenericPackageDescription</a> -&gt; <a href="Distribution-PackageDescription.html#t:PackageDescription">PackageDescription</a> <a href="src/Distribution-PackageDescription-Configuration.html#flattenPackageDescription" class="link">Source</a> <a href="#v:flattenPackageDescription" class="selflink">#</a></p><div class="doc"><p>Flatten a generic package description by ignoring all conditions and just
 join the field descriptors into on package description.  Note, however,
 that this may lead to inconsistent field values, since all values are
 joined into one field, which may not be possible in the original package
 description, due to the use of exclusive choices (if ... else ...).</p><p>TODO: One particularly tricky case is defaulting.  In the original package
 description, e.g., the source directory might either be the default or a
 certain, explicitly set path.  Since defaults are filled in only after the
 package has been resolved and when no explicit value has been set, the
 default path will be missing from the package description returned by this
 function.</p></div></div><div class="top"><p class="src"><a id="v:parseCondition" class="def">parseCondition</a> :: <a href="Distribution-Compat-ReadP.html#t:ReadP">ReadP</a> r (<a href="Distribution-PackageDescription.html#t:Condition">Condition</a> <a href="Distribution-PackageDescription.html#t:ConfVar">ConfVar</a>) <a href="src/Distribution-PackageDescription-Configuration.html#parseCondition" class="link">Source</a> <a href="#v:parseCondition" class="selflink">#</a></p><div class="doc"><p>Parse a configuration condition from a string.</p></div></div><div class="top"><p class="src"><a id="v:freeVars" class="def">freeVars</a> :: <a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a> <a href="Distribution-PackageDescription.html#t:ConfVar">ConfVar</a> c a -&gt; [<a href="Distribution-PackageDescription.html#t:FlagName">FlagName</a>] <a href="src/Distribution-PackageDescription-Configuration.html#freeVars" class="link">Source</a> <a href="#v:freeVars" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:extractCondition" class="def">extractCondition</a> :: <a href="../base-4.9.1.0/Data-Eq.html#t:Eq">Eq</a> v =&gt; (a -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; <a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a> v c a -&gt; <a href="Distribution-PackageDescription.html#t:Condition">Condition</a> v <a href="src/Distribution-PackageDescription-Configuration.html#extractCondition" class="link">Source</a> <a href="#v:extractCondition" class="selflink">#</a></p><div class="doc"><p>Extract the condition matched by the given predicate from a cond tree.</p><p>We use this mainly for extracting buildable conditions (see the Note above),
 but the function is in fact more general.</p></div></div><div class="top"><p class="src"><a id="v:extractConditions" class="def">extractConditions</a> :: (<a href="Distribution-PackageDescription.html#t:BuildInfo">BuildInfo</a> -&gt; <a href="../base-4.9.1.0/Data-Bool.html#t:Bool">Bool</a>) -&gt; <a href="Distribution-PackageDescription.html#t:GenericPackageDescription">GenericPackageDescription</a> -&gt; [<a href="Distribution-PackageDescription.html#t:Condition">Condition</a> <a href="Distribution-PackageDescription.html#t:ConfVar">ConfVar</a>] <a href="src/Distribution-PackageDescription-Configuration.html#extractConditions" class="link">Source</a> <a href="#v:extractConditions" class="selflink">#</a></p><div class="doc"><p>Extract conditions matched by the given predicate from all cond trees in a
 <code><a href="Distribution-PackageDescription.html#t:GenericPackageDescription">GenericPackageDescription</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:addBuildableCondition" class="def">addBuildableCondition</a> :: (<a href="../base-4.9.1.0/Data-Eq.html#t:Eq">Eq</a> v, <a href="Distribution-Compat-Semigroup.html#t:Monoid">Monoid</a> a, <a href="Distribution-Compat-Semigroup.html#t:Monoid">Monoid</a> c) =&gt; (a -&gt; <a href="Distribution-PackageDescription.html#t:BuildInfo">BuildInfo</a>) -&gt; <a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a> v c a -&gt; <a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a> v c a <a href="src/Distribution-PackageDescription-Configuration.html#addBuildableCondition" class="link">Source</a> <a href="#v:addBuildableCondition" class="selflink">#</a></p><div class="doc"><p>Transforms a <code><a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a></code> by putting the input under the &quot;then&quot; branch of a
 conditional that is True when Buildable is True. If <code><a href="Distribution-PackageDescription-Configuration.html#v:addBuildableCondition">addBuildableCondition</a></code>
 can determine that Buildable is always True, it returns the input unchanged.
 If Buildable is always False, it returns the empty <code><a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:mapCondTree" class="def">mapCondTree</a> :: (a -&gt; b) -&gt; (c -&gt; d) -&gt; (<a href="Distribution-PackageDescription.html#t:Condition">Condition</a> v -&gt; <a href="Distribution-PackageDescription.html#t:Condition">Condition</a> w) -&gt; <a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a> v c a -&gt; <a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a> w d b <a href="src/Distribution-PackageDescription-Configuration.html#mapCondTree" class="link">Source</a> <a href="#v:mapCondTree" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:mapTreeData" class="def">mapTreeData</a> :: (a -&gt; b) -&gt; <a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a> v c a -&gt; <a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a> v c b <a href="src/Distribution-PackageDescription-Configuration.html#mapTreeData" class="link">Source</a> <a href="#v:mapTreeData" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:mapTreeConds" class="def">mapTreeConds</a> :: (<a href="Distribution-PackageDescription.html#t:Condition">Condition</a> v -&gt; <a href="Distribution-PackageDescription.html#t:Condition">Condition</a> w) -&gt; <a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a> v c a -&gt; <a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a> w c a <a href="src/Distribution-PackageDescription-Configuration.html#mapTreeConds" class="link">Source</a> <a href="#v:mapTreeConds" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:mapTreeConstrs" class="def">mapTreeConstrs</a> :: (c -&gt; d) -&gt; <a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a> v c a -&gt; <a href="Distribution-PackageDescription.html#t:CondTree">CondTree</a> v d a <a href="src/Distribution-PackageDescription-Configuration.html#mapTreeConstrs" class="link">Source</a> <a href="#v:mapTreeConstrs" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:transformAllBuildInfos" class="def">transformAllBuildInfos</a> :: (<a href="Distribution-PackageDescription.html#t:BuildInfo">BuildInfo</a> -&gt; <a href="Distribution-PackageDescription.html#t:BuildInfo">BuildInfo</a>) -&gt; (<a href="Distribution-PackageDescription.html#t:SetupBuildInfo">SetupBuildInfo</a> -&gt; <a href="Distribution-PackageDescription.html#t:SetupBuildInfo">SetupBuildInfo</a>) -&gt; <a href="Distribution-PackageDescription.html#t:GenericPackageDescription">GenericPackageDescription</a> -&gt; <a href="Distribution-PackageDescription.html#t:GenericPackageDescription">GenericPackageDescription</a> <a href="src/Distribution-PackageDescription-Configuration.html#transformAllBuildInfos" class="link">Source</a> <a href="#v:transformAllBuildInfos" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:transformAllBuildDepends" class="def">transformAllBuildDepends</a> :: (<a href="Distribution-Package.html#t:Dependency">Dependency</a> -&gt; <a href="Distribution-Package.html#t:Dependency">Dependency</a>) -&gt; <a href="Distribution-PackageDescription.html#t:GenericPackageDescription">GenericPackageDescription</a> -&gt; <a href="Distribution-PackageDescription.html#t:GenericPackageDescription">GenericPackageDescription</a> <a href="src/Distribution-PackageDescription-Configuration.html#transformAllBuildDepends" class="link">Source</a> <a href="#v:transformAllBuildDepends" class="selflink">#</a></p><div class="doc"><p>Walk a <code><a href="Distribution-PackageDescription.html#t:GenericPackageDescription">GenericPackageDescription</a></code> and apply <code>f</code> to all nested
 <code>build-depends</code> fields.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.17.3</p></div></body></html>