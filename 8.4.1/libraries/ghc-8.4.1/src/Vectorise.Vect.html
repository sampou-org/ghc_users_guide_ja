<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |Simple vectorised constructors and projections.</span><span>
</span><a name="line-2"></a><span class="hs-comment">--</span><span>
</span><a name="line-3"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Vectorise.Vect</span><span>
</span><a name="line-4"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Vectorise.Vect.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span class="hs-special">,</span><span> </span><a href="Vectorise.Vect.html#VVar"><span class="hs-identifier hs-type">VVar</span></a><span class="hs-special">,</span><span> </span><a href="Vectorise.Vect.html#VExpr"><span class="hs-identifier hs-type">VExpr</span></a><span class="hs-special">,</span><span> </span><a href="Vectorise.Vect.html#VBind"><span class="hs-identifier hs-type">VBind</span></a><span>
</span><a name="line-5"></a><span>
</span><a name="line-6"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Vectorise.Vect.html#vectorised"><span class="hs-identifier hs-var">vectorised</span></a><span>
</span><a name="line-7"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Vectorise.Vect.html#lifted"><span class="hs-identifier hs-var">lifted</span></a><span>
</span><a name="line-8"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Vectorise.Vect.html#mapVect"><span class="hs-identifier hs-var">mapVect</span></a><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Vectorise.Vect.html#vVarType"><span class="hs-identifier hs-var">vVarType</span></a><span>
</span><a name="line-11"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Vectorise.Vect.html#vNonRec"><span class="hs-identifier hs-var">vNonRec</span></a><span>
</span><a name="line-12"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Vectorise.Vect.html#vRec"><span class="hs-identifier hs-var">vRec</span></a><span>
</span><a name="line-13"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Vectorise.Vect.html#vVar"><span class="hs-identifier hs-var">vVar</span></a><span>
</span><a name="line-14"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Vectorise.Vect.html#vType"><span class="hs-identifier hs-var">vType</span></a><span>
</span><a name="line-15"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Vectorise.Vect.html#vTick"><span class="hs-identifier hs-var">vTick</span></a><span>
</span><a name="line-16"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Vectorise.Vect.html#vLet"><span class="hs-identifier hs-var">vLet</span></a><span>
</span><a name="line-17"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Vectorise.Vect.html#vLams"><span class="hs-identifier hs-var">vLams</span></a><span>
</span><a name="line-18"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Vectorise.Vect.html#vVarApps"><span class="hs-identifier hs-var">vVarApps</span></a><span>
</span><a name="line-19"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Vectorise.Vect.html#vCaseDEFAULT"><span class="hs-identifier hs-var">vCaseDEFAULT</span></a><span>
</span><a name="line-20"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-21"></a><span class="hs-keyword">where</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><a href="GhcPrelude.html"><span class="hs-identifier">GhcPrelude</span></a><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><a href="CoreSyn.html"><span class="hs-identifier">CoreSyn</span></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><a href="Type.html"><span class="hs-identifier">Type</span></a><span>           </span><span class="hs-special">(</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span class="hs-keyword">import</span><span> </span><a href="Var.html"><span class="hs-identifier">Var</span></a><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-comment">-- |Contains the vectorised and lifted versions of some thing.</span><span>
</span><a name="line-30"></a><span class="hs-comment">--</span><span>
</span><a name="line-31"></a><span class="hs-keyword">type</span><span> </span><a name="Vect"><a href="Vectorise.Vect.html#Vect"><span class="hs-identifier">Vect</span></a></a><span> </span><a name="local-6989586621680328472"><a href="#local-6989586621680328472"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680328472"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621680328472"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-32"></a><span class="hs-keyword">type</span><span> </span><a name="VVar"><a href="Vectorise.Vect.html#VVar"><span class="hs-identifier">VVar</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Vectorise.Vect.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>
</span><a name="line-33"></a><span class="hs-keyword">type</span><span> </span><a name="VExpr"><a href="Vectorise.Vect.html#VExpr"><span class="hs-identifier">VExpr</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Vectorise.Vect.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="CoreSyn.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a><span>
</span><a name="line-34"></a><span class="hs-keyword">type</span><span> </span><a name="VBind"><a href="Vectorise.Vect.html#VBind"><span class="hs-identifier">VBind</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Vectorise.Vect.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="CoreSyn.html#CoreBind"><span class="hs-identifier hs-type">CoreBind</span></a><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span class="hs-comment">-- |Get the vectorised version of a thing.</span><span>
</span><a name="line-37"></a><span class="hs-comment">--</span><span>
</span><a name="line-38"></a><span class="hs-identifier">vectorised</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Vectorise.Vect.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621680328479"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680328479"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-39"></a><a name="vectorised"><a href="Vectorise.Vect.html#vectorised"><span class="hs-identifier">vectorised</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span class="hs-comment">-- |Get the lifted version of a thing.</span><span>
</span><a name="line-42"></a><span class="hs-comment">--</span><span>
</span><a name="line-43"></a><span class="hs-identifier">lifted</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Vectorise.Vect.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621680328478"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680328478"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-44"></a><a name="lifted"><a href="Vectorise.Vect.html#lifted"><span class="hs-identifier">lifted</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-comment">-- |Apply some function to both the vectorised and lifted versions of a thing.</span><span>
</span><a name="line-47"></a><span class="hs-comment">--</span><span>
</span><a name="line-48"></a><span class="hs-identifier">mapVect</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680328476"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680328477"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Vect.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621680328476"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Vect.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621680328477"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-49"></a><a name="mapVect"><a href="Vectorise.Vect.html#mapVect"><span class="hs-identifier">mapVect</span></a></a><span> </span><a name="local-6989586621680328480"><a href="#local-6989586621680328480"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680328481"><a href="#local-6989586621680328481"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680328482"><a href="#local-6989586621680328482"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680328480"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621680328481"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680328480"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621680328482"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-comment">-- |Combine vectorised and lifted versions of two things componentwise.</span><span>
</span><a name="line-52"></a><span class="hs-comment">--</span><span>
</span><a name="line-53"></a><span class="hs-identifier">zipWithVect</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680328473"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680328474"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621680328475"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Vect.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621680328473"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Vect.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621680328474"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Vect.html#Vect"><span class="hs-identifier hs-type">Vect</span></a><span> </span><a href="#local-6989586621680328475"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-54"></a><a name="zipWithVect"><a href="Vectorise.Vect.html#zipWithVect"><span class="hs-identifier">zipWithVect</span></a></a><span> </span><a name="local-6989586621680328483"><a href="#local-6989586621680328483"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680328484"><a href="#local-6989586621680328484"><span class="hs-identifier">x1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680328485"><a href="#local-6989586621680328485"><span class="hs-identifier">y1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680328486"><a href="#local-6989586621680328486"><span class="hs-identifier">x2</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680328487"><a href="#local-6989586621680328487"><span class="hs-identifier">y2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680328483"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621680328484"><span class="hs-identifier hs-var">x1</span></a><span> </span><a href="#local-6989586621680328486"><span class="hs-identifier hs-var">x2</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680328483"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621680328485"><span class="hs-identifier hs-var">y1</span></a><span> </span><a href="#local-6989586621680328487"><span class="hs-identifier hs-var">y2</span></a><span class="hs-special">)</span><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span class="hs-comment">-- |Get the type of a vectorised variable.</span><span>
</span><a name="line-57"></a><span class="hs-comment">--</span><span>
</span><a name="line-58"></a><span class="hs-identifier">vVarType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Vectorise.Vect.html#VVar"><span class="hs-identifier hs-type">VVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-59"></a><a name="vVarType"><a href="Vectorise.Vect.html#vVarType"><span class="hs-identifier">vVarType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">varType</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Vectorise.Vect.html#vectorised"><span class="hs-identifier hs-var">vectorised</span></a><span>
</span><a name="line-60"></a><span>
</span><a name="line-61"></a><span class="hs-comment">-- |Wrap a vectorised variable as a vectorised expression.</span><span>
</span><a name="line-62"></a><span class="hs-comment">--</span><span>
</span><a name="line-63"></a><span class="hs-identifier">vVar</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Vectorise.Vect.html#VVar"><span class="hs-identifier hs-type">VVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Vect.html#VExpr"><span class="hs-identifier hs-type">VExpr</span></a><span>
</span><a name="line-64"></a><a name="vVar"><a href="Vectorise.Vect.html#vVar"><span class="hs-identifier">vVar</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Vectorise.Vect.html#mapVect"><span class="hs-identifier hs-var">mapVect</span></a><span> </span><a href="CoreSyn.html#Var"><span class="hs-identifier hs-var">Var</span></a><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span class="hs-comment">-- |Wrap a vectorised type as a vectorised expression.</span><span>
</span><a name="line-67"></a><span class="hs-comment">--</span><span>
</span><a name="line-68"></a><span class="hs-identifier">vType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Vect.html#VExpr"><span class="hs-identifier hs-type">VExpr</span></a><span>
</span><a name="line-69"></a><a name="vType"><a href="Vectorise.Vect.html#vType"><span class="hs-identifier">vType</span></a></a><span> </span><a name="local-6989586621680328488"><a href="#local-6989586621680328488"><span class="hs-identifier">ty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><a href="#local-6989586621680328488"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">,</span><span> </span><a href="CoreSyn.html#Type"><span class="hs-identifier hs-var">Type</span></a><span> </span><a href="#local-6989586621680328488"><span class="hs-identifier hs-var">ty</span></a><span class="hs-special">)</span><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span class="hs-comment">-- |Make a vectorised note.</span><span>
</span><a name="line-72"></a><span class="hs-comment">--</span><span>
</span><a name="line-73"></a><span class="hs-identifier">vTick</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CoreSyn.html#Tickish"><span class="hs-identifier hs-type">Tickish</span></a><span> </span><a href="Var.html#Id"><span class="hs-identifier hs-type">Id</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Vect.html#VExpr"><span class="hs-identifier hs-type">VExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Vect.html#VExpr"><span class="hs-identifier hs-type">VExpr</span></a><span>
</span><a name="line-74"></a><a name="vTick"><a href="Vectorise.Vect.html#vTick"><span class="hs-identifier">vTick</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Vectorise.Vect.html#mapVect"><span class="hs-identifier hs-var">mapVect</span></a><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="CoreSyn.html#Tick"><span class="hs-identifier hs-var">Tick</span></a><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span class="hs-comment">-- |Make a vectorised non-recursive binding.</span><span>
</span><a name="line-77"></a><span class="hs-comment">--</span><span>
</span><a name="line-78"></a><span class="hs-identifier">vNonRec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Vectorise.Vect.html#VVar"><span class="hs-identifier hs-type">VVar</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Vect.html#VExpr"><span class="hs-identifier hs-type">VExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Vect.html#VBind"><span class="hs-identifier hs-type">VBind</span></a><span>
</span><a name="line-79"></a><a name="vNonRec"><a href="Vectorise.Vect.html#vNonRec"><span class="hs-identifier">vNonRec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Vectorise.Vect.html#zipWithVect"><span class="hs-identifier hs-var">zipWithVect</span></a><span> </span><a href="CoreSyn.html#NonRec"><span class="hs-identifier hs-var">NonRec</span></a><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-comment">-- |Make a vectorised recursive binding.</span><span>
</span><a name="line-82"></a><span class="hs-comment">--</span><span>
</span><a name="line-83"></a><span class="hs-identifier">vRec</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Vectorise.Vect.html#VVar"><span class="hs-identifier hs-type">VVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Vectorise.Vect.html#VExpr"><span class="hs-identifier hs-type">VExpr</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Vect.html#VBind"><span class="hs-identifier hs-type">VBind</span></a><span>
</span><a name="line-84"></a><a name="vRec"><a href="Vectorise.Vect.html#vRec"><span class="hs-identifier">vRec</span></a></a><span> </span><a name="local-6989586621680328489"><a href="#local-6989586621680328489"><span class="hs-identifier">vs</span></a></a><span> </span><a name="local-6989586621680328490"><a href="#local-6989586621680328490"><span class="hs-identifier">es</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Rec"><span class="hs-identifier hs-var">Rec</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a><span> </span><a href="#local-6989586621680328491"><span class="hs-identifier hs-var">vvs</span></a><span> </span><a href="#local-6989586621680328493"><span class="hs-identifier hs-var">ves</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="CoreSyn.html#Rec"><span class="hs-identifier hs-var">Rec</span></a><span> </span><span class="hs-special">(</span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a><span> </span><a href="#local-6989586621680328492"><span class="hs-identifier hs-var">lvs</span></a><span> </span><a href="#local-6989586621680328494"><span class="hs-identifier hs-var">les</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-86"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621680328491"><a href="#local-6989586621680328491"><span class="hs-identifier">vvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680328492"><a href="#local-6989586621680328492"><span class="hs-identifier">lvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a><span> </span><a href="#local-6989586621680328489"><span class="hs-identifier hs-var">vs</span></a><span>
</span><a name="line-87"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621680328493"><a href="#local-6989586621680328493"><span class="hs-identifier">ves</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680328494"><a href="#local-6989586621680328494"><span class="hs-identifier">les</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a><span> </span><a href="#local-6989586621680328490"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span class="hs-comment">-- |Make a vectorised let expression.</span><span>
</span><a name="line-90"></a><span class="hs-comment">--</span><span>
</span><a name="line-91"></a><span class="hs-identifier">vLet</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Vectorise.Vect.html#VBind"><span class="hs-identifier hs-type">VBind</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Vect.html#VExpr"><span class="hs-identifier hs-type">VExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Vect.html#VExpr"><span class="hs-identifier hs-type">VExpr</span></a><span>
</span><a name="line-92"></a><a name="vLet"><a href="Vectorise.Vect.html#vLet"><span class="hs-identifier">vLet</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Vectorise.Vect.html#zipWithVect"><span class="hs-identifier hs-var">zipWithVect</span></a><span> </span><a href="CoreSyn.html#Let"><span class="hs-identifier hs-var">Let</span></a><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span class="hs-comment">-- |Make a vectorised lambda abstraction.</span><span>
</span><a name="line-95"></a><span class="hs-comment">--</span><span>
</span><a name="line-96"></a><span class="hs-comment">-- The lifted version also binds the lifting context 'lc'.</span><span>
</span><a name="line-97"></a><span class="hs-comment">--</span><span>
</span><a name="line-98"></a><span class="hs-identifier">vLams</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span>      </span><span class="hs-comment">-- ^ Var bound to the lifting context.</span><span>
</span><a name="line-99"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Vectorise.Vect.html#VVar"><span class="hs-identifier hs-type">VVar</span></a><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- ^ Parameter vars for the abstraction.</span><span>
</span><a name="line-100"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Vect.html#VExpr"><span class="hs-identifier hs-type">VExpr</span></a><span>    </span><span class="hs-comment">-- ^ Body of the abstraction.</span><span>
</span><a name="line-101"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Vect.html#VExpr"><span class="hs-identifier hs-type">VExpr</span></a><span>
</span><a name="line-102"></a><a name="vLams"><a href="Vectorise.Vect.html#vLams"><span class="hs-identifier">vLams</span></a></a><span> </span><a name="local-6989586621680328495"><a href="#local-6989586621680328495"><span class="hs-identifier">lc</span></a></a><span> </span><a name="local-6989586621680328496"><a href="#local-6989586621680328496"><span class="hs-identifier">vs</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680328497"><a href="#local-6989586621680328497"><span class="hs-identifier">ve</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680328498"><a href="#local-6989586621680328498"><span class="hs-identifier">le</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#mkLams"><span class="hs-identifier hs-var">mkLams</span></a><span> </span><a href="#local-6989586621680328499"><span class="hs-identifier hs-var">vvs</span></a><span> </span><a href="#local-6989586621680328497"><span class="hs-identifier hs-var">ve</span></a><span class="hs-special">,</span><span> </span><a href="CoreSyn.html#mkLams"><span class="hs-identifier hs-var">mkLams</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680328495"><span class="hs-identifier hs-var">lc</span></a><span class="hs-glyph">:</span><a href="#local-6989586621680328500"><span class="hs-identifier hs-var">lvs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621680328498"><span class="hs-identifier hs-var">le</span></a><span class="hs-special">)</span><span>
</span><a name="line-104"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-105"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621680328499"><a href="#local-6989586621680328499"><span class="hs-identifier">vvs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680328500"><a href="#local-6989586621680328500"><span class="hs-identifier">lvs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a><span> </span><a href="#local-6989586621680328496"><span class="hs-identifier hs-var">vs</span></a><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-comment">-- |Apply an expression to a set of argument variables.</span><span>
</span><a name="line-108"></a><span class="hs-comment">--</span><span>
</span><a name="line-109"></a><span class="hs-comment">-- The lifted version is also applied to the variable of the lifting context.</span><span>
</span><a name="line-110"></a><span class="hs-comment">--</span><span>
</span><a name="line-111"></a><span class="hs-identifier">vVarApps</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Var.html#Var"><span class="hs-identifier hs-type">Var</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Vect.html#VExpr"><span class="hs-identifier hs-type">VExpr</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Vectorise.Vect.html#VVar"><span class="hs-identifier hs-type">VVar</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Vect.html#VExpr"><span class="hs-identifier hs-type">VExpr</span></a><span>
</span><a name="line-112"></a><a name="vVarApps"><a href="Vectorise.Vect.html#vVarApps"><span class="hs-identifier">vVarApps</span></a></a><span> </span><a name="local-6989586621680328501"><a href="#local-6989586621680328501"><span class="hs-identifier">lc</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680328502"><a href="#local-6989586621680328502"><span class="hs-identifier">ve</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680328503"><a href="#local-6989586621680328503"><span class="hs-identifier">le</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680328504"><a href="#local-6989586621680328504"><span class="hs-identifier">vvs</span></a></a><span>
</span><a name="line-113"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680328502"><span class="hs-identifier hs-var">ve</span></a><span> </span><span class="hs-special">`</span><a href="CoreSyn.html#mkVarApps"><span class="hs-identifier hs-var">mkVarApps</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621680328505"><span class="hs-identifier hs-var">vs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621680328503"><span class="hs-identifier hs-var">le</span></a><span> </span><span class="hs-special">`</span><a href="CoreSyn.html#mkVarApps"><span class="hs-identifier hs-var">mkVarApps</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621680328501"><span class="hs-identifier hs-var">lc</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621680328506"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-114"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-115"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621680328505"><a href="#local-6989586621680328505"><span class="hs-identifier">vs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680328506"><a href="#local-6989586621680328506"><span class="hs-identifier">ls</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.11.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a><span> </span><a href="#local-6989586621680328504"><span class="hs-identifier hs-var">vvs</span></a><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-identifier">vCaseDEFAULT</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Vectorise.Vect.html#VExpr"><span class="hs-identifier hs-type">VExpr</span></a><span>  </span><span class="hs-comment">-- scrutinee</span><span>
</span><a name="line-119"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Vect.html#VVar"><span class="hs-identifier hs-type">VVar</span></a><span>   </span><span class="hs-comment">-- bnder</span><span>
</span><a name="line-120"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>   </span><span class="hs-comment">-- type of vectorised version</span><span>
</span><a name="line-121"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TyCoRep.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>   </span><span class="hs-comment">-- type of lifted version</span><span>
</span><a name="line-122"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Vect.html#VExpr"><span class="hs-identifier hs-type">VExpr</span></a><span>  </span><span class="hs-comment">-- body of alternative.</span><span>
</span><a name="line-123"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Vectorise.Vect.html#VExpr"><span class="hs-identifier hs-type">VExpr</span></a><span>
</span><a name="line-124"></a><a name="vCaseDEFAULT"><a href="Vectorise.Vect.html#vCaseDEFAULT"><span class="hs-identifier">vCaseDEFAULT</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680328507"><a href="#local-6989586621680328507"><span class="hs-identifier">vscrut</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680328508"><a href="#local-6989586621680328508"><span class="hs-identifier">lscrut</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621680328509"><a href="#local-6989586621680328509"><span class="hs-identifier">vbndr</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680328510"><a href="#local-6989586621680328510"><span class="hs-identifier">lbndr</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621680328511"><a href="#local-6989586621680328511"><span class="hs-identifier">vty</span></a></a><span> </span><a name="local-6989586621680328512"><a href="#local-6989586621680328512"><span class="hs-identifier">lty</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621680328513"><a href="#local-6989586621680328513"><span class="hs-identifier">vbody</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621680328514"><a href="#local-6989586621680328514"><span class="hs-identifier">lbody</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="CoreSyn.html#Case"><span class="hs-identifier hs-var">Case</span></a><span> </span><a href="#local-6989586621680328507"><span class="hs-identifier hs-var">vscrut</span></a><span> </span><a href="#local-6989586621680328509"><span class="hs-identifier hs-var">vbndr</span></a><span> </span><a href="#local-6989586621680328511"><span class="hs-identifier hs-var">vty</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680328515"><span class="hs-identifier hs-var">mkDEFAULT</span></a><span> </span><a href="#local-6989586621680328513"><span class="hs-identifier hs-var">vbody</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-126"></a><span>     </span><a href="CoreSyn.html#Case"><span class="hs-identifier hs-var">Case</span></a><span> </span><a href="#local-6989586621680328508"><span class="hs-identifier hs-var">lscrut</span></a><span> </span><a href="#local-6989586621680328510"><span class="hs-identifier hs-var">lbndr</span></a><span> </span><a href="#local-6989586621680328512"><span class="hs-identifier hs-var">lty</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621680328515"><span class="hs-identifier hs-var">mkDEFAULT</span></a><span> </span><a href="#local-6989586621680328514"><span class="hs-identifier hs-var">lbody</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-127"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-128"></a><span>    </span><a name="local-6989586621680328515"><a href="#local-6989586621680328515"><span class="hs-identifier">mkDEFAULT</span></a></a><span> </span><a name="local-6989586621680328516"><a href="#local-6989586621680328516"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="CoreSyn.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621680328516"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-129"></a></pre></body></html>